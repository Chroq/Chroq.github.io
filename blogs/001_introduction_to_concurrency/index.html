<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=icon href=/images/white-cloud-002.webp type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Oswald:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Oswald:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Oswald:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="101 - La concurrence en Go"><meta property="og:description" content="Ce premier article a pour but d'expliquer les concepts relatifs à la concurrence en Go. Il servira de base aux prochains articles qui aborderont des notions plus avancées."><meta property="og:type" content="article"><meta property="og:url" content="https://github.com/blogs/001_introduction_to_concurrency/"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2022-11-14T11:11:24+02:00"><meta property="article:modified_time" content="2022-11-14T11:11:24+02:00"><meta property="og:site_name" content="Christophe Lecroq"><meta name=twitter:card content="summary"><meta name=twitter:title content="101 - La concurrence en Go"><meta name=twitter:description content="Ce premier article a pour but d'expliquer les concepts relatifs à la concurrence en Go. Il servira de base aux prochains articles qui aborderont des notions plus avancées."><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi crossorigin=anonymous><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}</style><meta name=description content="Ce premier article a pour but d'expliquer les concepts relatifs à la concurrence en Go. Il servira de base aux prochains articles qui aborderont des notions plus avancées."><link rel=stylesheet href=/css/single.css><title>101 - La concurrence en Go | Christophe Lecroq - Développeur Go & PHP</title></head><body class=light onload=loading()><header><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/images/white-cloud-002.webp width=30 height=30 class="d-inline-block align-top">
Christophe Lecroq</a>
<button class=navbar-toggler type=button data-toggle=collapse href=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>À propos</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">101 - La concurrence en Go</h1><div class=text-center>Christophe Lecroq
<small>|</small>
14 Nov 2022</div></div><div class=featured-image><img class=img-fluid src=/images/001_introduction_to_concurrency/001_introduction_to_concurrency.webp alt="101 - La concurrence en Go"></div><article class="page-content p-2"><p>Ce premier article a pour but d&rsquo;expliquer les concepts de base de la concurrence en Go : goroutine, channels et select.</p><h2 id=pré-requis>Pré-requis</h2><p>Pour bien suivre ce tutoriel, vous aurez besoin :</p><ul><li>d&rsquo;une installation fonctionnelle de Golang (je travaille sur la version 1.19 mais les concepts expliqués ici existent dans les versions antérieures</li><li>d&rsquo;une connaissance de base du langage Go</li></ul><p>Vous pouvez retrouver tout le code source des exemples (001_*) <a href=https://github.com/Chroq/tutorial target=_blank>ici</a>.</p><h2 id=quest-ce-que-la-concurrence->Qu&rsquo;est ce que la concurrence ?</h2><p>Précisons d&rsquo;abord ce qu&rsquo;est la concurrence en programmation. Le concept, de manière simplifiée, pourrait se résumer de la manière suivante : <strong>effectuer des traitements multiples de durées indéfinies sans notion d&rsquo;ordre</strong>.</p><p>L&rsquo;exemple du serveur web HTTP revient fréquemment quand on évoque le principe de la concurrence. Il reçoit, traite et distribue les requêtes de manière concurrente.</p><p>Sans rentrer dans le détail, sachez quand même qui existe une différence entre la concurrence et le parallélisme. Si vous souhaitez plus d&rsquo;informations sur la question, je vous redirige vers <a href="https://www.youtube.com/watch?v=Y1pgpn2gOSg" target=_blank>cette vidéo</a>.</p><h2 id=la-concurrence-en-go>La concurrence en Go</h2><h3 id=les-goroutines>Les Goroutines</h3><p>Quand vous souhaitez détacher une tâche de votre programme principal pour qu&rsquo;elle s&rsquo;exécute de manière concurrente, vous utiliserez une <code>goroutine</code>.
Pour la déclarer, Golang fournit l&rsquo;instruction éponyme <code>go</code>, c&rsquo;est dire comme le concept est central pour ce langage.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>go</span> <span style=color:#a6e22e>myFunction</span>()
</span></span></code></pre></div><p>Placé devant l&rsquo;appel d&rsquo;une fonction, ce mot-clé vous permet de détacher une nouvelle goroutine (un processus léger). Ce sous-programme va s&rsquo;exécuter dans un <code>thread</code> géré par le runtime de Golang. Je ne rentrerais pas ici dans le détail de ce qu&rsquo;est le runtime car la notion mériterait un article en tant que tel, comprenez juste qu&rsquo;il s&rsquo;agit de l&rsquo;interface fournie par Golang entre votre programme et le système d&rsquo;exploitation.</p><h3 id=les-channels>Les channels</h3><p>les <code>channels</code> permettent de manipuler les données entre vos sous-programmes (goroutines).</p><p>Comme vous le savez le Go est un langage à typage fort et chaque <code>channel</code> a un type propre (int, string,<code>channel</code>, etc).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>myChan</span> = make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>myChan2</span> <span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>
</span></span></code></pre></div><p>Vous pouvez utiliser les deux manières d&rsquo;initialiser un channel.</p><p>Les <code>channels</code> sont bi-directionels (entrée/sortie) et <strong>bloquants</strong>, c&rsquo;est à dire qu&rsquo;une fois la valeur écrite à l&rsquo;intérieur, vous devez la lire pour continuer le traitement.</p><h2 id=programmes-concurrents>Programmes concurrents</h2><h3 id=utilisation-basique-des-goroutines>Utilisation basique des goroutines</h3><p>Puisqu&rsquo;on en a finit avec la terminologie, voyons un peu de code !</p><p>Le but est de lancer deux goroutines et de retarder l&rsquo;affichage du nom passé en paramètre en fonction de sa longueur.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// shout prints an uppercased name n times, the longer the name the longer the delay
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>shout</span>(<span style=color:#a6e22e>number</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>number</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>ToUpper</span>(<span style=color:#a6e22e>name</span>))
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sleep</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Duration</span>(len(<span style=color:#a6e22e>name</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>shout</span>(<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#34;Galadrielle&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>shout</span>(<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#34;Arwen&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Scanln</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>J&rsquo;appelle donc deux fois cette fonction, la première avec un prénom long (donc qui s&rsquo;affichera moins rapidement) et la seconde avec un prénom court.</p><p>Vous noterez deux choses. La première c&rsquo;est que devant les deux appels de fonctions se trouve le mot clé <code>go</code>. La seconde c&rsquo;est que j&rsquo;appelle la fonction <code>fmt.Scanln()</code> pour que le programme ne s&rsquo;arrête pas une fois les instructions lancées. En effet, votre programme principal n&rsquo;a pas connaissance (<strong>Spoiler alert</strong> pour l&rsquo;instant) de l&rsquo;exécution de sous-programmes et va se terminer sans attendre le traitement des <code>goroutines</code>.</p><p>Donc, si vous lancez le programme vous obtiendrez la sortie suivante :</p><pre tabindex=0><code>GALADRIELLE
ARWEN
ARWEN
ARWEN
GALADRIELLE
GALADRIELLE
</code></pre><p>Les deux premières lignes correspondent respectivement à l&rsquo;exécution des premières itérations de chaque fonction avec <code>Galadrielle</code> et <code>Arwen</code>.</p><p>À ce stade-là, les fonctions <code>Sleep</code> sont appellées. Le délai pour <code>Arwen</code> étant beaucoup plus court (500 millisecondes) que celui de <code>Galadrielle</code> (1100 millisecondes), la boucle se termine avant celle de <code>Galadrielle</code>.</p><h3 id=communication-entre-goroutines>Communication entre Goroutines</h3><p>Le premier programme ne permet pas de faire grand chose. En effet, chaque goroutines va s&rsquo;exécuter de manière indépendante sans échanger quoi que ce soit avec notre programme principal ou une autre <code>goroutine</code>.</p><p>Voyons maintenant le code suivant :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>BalrogHP</span> = <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>LegolasShootArrow</span>(<span style=color:#a6e22e>damage</span> <span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>damage</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>damage</span> <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sleep</span>(<span style=color:#ae81ff>100</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>GandalfCastsSpell</span>(<span style=color:#a6e22e>damage</span> <span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>damage</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>damage</span> <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sleep</span>(<span style=color:#ae81ff>250</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>DisplayBalrogHP</span>(<span style=color:#a6e22e>LegolasDamage</span>, <span style=color:#a6e22e>GandalfDamage</span> <span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>balrogHP</span> = <span style=color:#a6e22e>BalrogHP</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>LegolasDamage</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>GandalfDamage</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>incomingDamage</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>select</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>incomingDamage</span> = <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>LegolasDamage</span>:
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Legolas shoots an arrow !&#34;</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>incomingDamage</span> = <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>GandalfDamage</span>:
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Gandalf casts a spell !&#34;</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>balrogHP</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>incomingDamage</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;Balrog HP : %d\n&#34;</span>, <span style=color:#a6e22e>balrogHP</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>balrogHP</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>LegolasDamage</span>, <span style=color:#a6e22e>GandalfDamage</span> = <span style=color:#66d9ef>nil</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;Balrog is dead !&#34;</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>LegolasDamage</span>, <span style=color:#a6e22e>GandalfDamage</span> = make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>), make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>LegolasShootArrow</span>(<span style=color:#a6e22e>LegolasDamage</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>GandalfCastsSpell</span>(<span style=color:#a6e22e>GandalfDamage</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>DisplayBalrogHP</span>(<span style=color:#a6e22e>LegolasDamage</span>, <span style=color:#a6e22e>GandalfDamage</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Scanln</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Supposons que vous soyez obligé d&rsquo;affronter un <a href=https://fr.wikipedia.org/wiki/Balrog target=_blank>Balrog</a>. La tâche nécessite le concours de plusieurs protagonistes <a href=https://fr.wikipedia.org/wiki/Legolas target=_blank>le rapide Legolas</a> et <a href=https://fr.wikipedia.org/wiki/Gandalf target=_blank>le puissant (mais plus lent) Gandalf</a>. Ici, chacun des héros attaque avec sa vitesse et ses dommages propres.</p><p>Revenons à nos <code>channels</code>, l&rsquo;idée principale est de déclarer un channel pour chacune des fonctions liées aux personnages et de les passer à une fonction d&rsquo;affichage de la vie du Balrog. Comme vous l&rsquo;aurez remarqué, chaque appel de fonctions se fait de manière concurrente.</p><p>Si on execute le programme, on aura la sortie suivante :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#a6e22e>Gandalf</span> <span style=color:#a6e22e>casts</span> <span style=color:#a6e22e>a</span> <span style=color:#a6e22e>spell</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Legolas</span> <span style=color:#a6e22e>shoots</span> <span style=color:#a6e22e>an</span> <span style=color:#a6e22e>arrow</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>14</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Legolas</span> <span style=color:#a6e22e>shoots</span> <span style=color:#a6e22e>an</span> <span style=color:#a6e22e>arrow</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>13</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Legolas</span> <span style=color:#a6e22e>shoots</span> <span style=color:#a6e22e>an</span> <span style=color:#a6e22e>arrow</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Gandalf</span> <span style=color:#a6e22e>casts</span> <span style=color:#a6e22e>a</span> <span style=color:#a6e22e>spell</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Legolas</span> <span style=color:#a6e22e>shoots</span> <span style=color:#a6e22e>an</span> <span style=color:#a6e22e>arrow</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Legolas</span> <span style=color:#a6e22e>shoots</span> <span style=color:#a6e22e>an</span> <span style=color:#a6e22e>arrow</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Gandalf</span> <span style=color:#a6e22e>casts</span> <span style=color:#a6e22e>a</span> <span style=color:#a6e22e>spell</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>HP</span> : <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Balrog</span> <span style=color:#a6e22e>is</span> <span style=color:#a6e22e>dead</span> !
</span></span></code></pre></div><p>NB : Si vous exécutez le code chez vous, il est possible que la sortie diffère un petit peu. Les fonctions étant appelées l&rsquo;une derrière l&rsquo;autre, il arrive que la fonction de Gandalf (comme sur l&rsquo;exemple ci-dessus) s&rsquo;exécute en premier. C&rsquo;est normal et vous devrez vous habituer quand vous travaillez en asynchrone à ce que l&rsquo;ordre d&rsquo;exécution puisse être aléatoire si les fonctions se déclenchent quasiment en même temps.</p><p>Le déroulement est donc ici le suivant :</p><ul><li>Le programme lance les trois <code>goroutines</code></li><li>le <code>select</code> se comporte ici comme un <code>switch</code>. C&rsquo;est une instruction spécifique aux channels qui va attribuer la valeur écrite dans le <code>channel</code> à une variable et exécuter du code spécifique.</li><li>On remarque bien que le <code>channel LegolasDamage</code> est écrit plus fréquemment que le <code>channel GandalDamage</code></li><li>Enfin, pour éviter que le programme ne continue de s&rsquo;exécuter, je place les deux <code>channels</code> à nil pour sortir des boucles.</li></ul><h3 id=conclusion>Conclusion</h3><p>J&rsquo;espère que vous avez désormais une meilleure vision de ce que sont les <code>goroutines</code>, <code>channels</code> et de la concurrence en Go. Il s&rsquo;agit d&rsquo;une première approche pour appréhender les concepts de base de la concurrence et le prochain article traitera plus en profondeur des channels.</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table des matières</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#pré-requis>Pré-requis</a></li><li><a href=#quest-ce-que-la-concurrence->Qu&rsquo;est ce que la concurrence ?</a></li><li><a href=#la-concurrence-en-go>La concurrence en Go</a><ul><li><a href=#les-goroutines>Les Goroutines</a></li><li><a href=#les-channels>Les channels</a></li></ul></li><li><a href=#programmes-concurrents>Programmes concurrents</a><ul><li><a href=#utilisation-basique-des-goroutines>Utilisation basique des goroutines</a></li><li><a href=#communication-entre-goroutines>Communication entre Goroutines</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://github.com/tags/golang target=_blank>Golang</a></li><li class=list-inline-item><a href=https://github.com/tags/concurrence target=_blank>Concurrence</a></li><li class=list-inline-item><a href=https://github.com/tags/goroutines target=_blank>Goroutines</a></li><li class=list-inline-item><a href=https://github.com/tags/asynchrone target=_blank>Asynchrone</a></li></ul></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script></div><footer><div class="container py-3" id=recent-posts></div><div class="text-center pt-2"></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://github.com title="Christophe Lecroq - Développeur Go & PHP"><img alt="Christophe Lecroq Logo" src=/images/white-cloud-002.webp height=200px width=200px></a></div>&copy; 2022 All Rights Reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;</span>
and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js integrity=sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s crossorigin=anonymous></script>
<script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script>let loadingIcons;function loading(){myVar=setTimeout(showPage,100)}function showPage(){try{document.getElementById("loading-icons").style.display="block"}catch{}}</script></body></html>